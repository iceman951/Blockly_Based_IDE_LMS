<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Answers</title>
</head>

<body>
  <%- include('../layout'); -%>
    <br>
    <div class="container">
      <h5>คำตอบนักเรียน</h5>
      <p>กลุ่ม <%= locals.group_id %> </p>

      <% var count101 = 0 %>
      <% var count201 = 0 %>
      <% var count202 = 0 %>
      <% var count203 = 0 %>
      <% var count301 = 0 %>

      <% if(problem_number == "101") problem_number = "1.1"%>
      <% if(problem_number == "201") problem_number = "2.1"%>
      <% if(problem_number == "202") problem_number = "2.2"%>
      <% if(problem_number == "203") problem_number = "2.3"%>
      <% if(problem_number == "301") problem_number = "3.1"%>

      <% for (var result of locals.answers){ %>
        <% if(result.problem_id == "101" && result.checked == false) count101++ %>
        <% if(result.problem_id == "201" && result.checked == false) count201++ %>
        <% if(result.problem_id == "202" && result.checked == false) count202++ %>
        <% if(result.problem_id == "203" && result.checked == false) count203++ %>
        <% if(result.problem_id == "301" && result.checked == false) count301++ %>
      <%}%>
      
      <% if(count101 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count101 %> ข้อ</p> 
      <% } %>

      <% if(count201 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count201 %> ข้อ</p> 
      <% } %>

      <% if(count202 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count202 %> ข้อ</p> 
      <% } %>

      <% if(count203 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count203 %> ข้อ</p> 
      <% } %>

      <% if(count301 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count301 %> ข้อ</p> 
      <% } %>

      <% if(count203 != 0) { %>
        <p>กำลังตรวจข้อ <%= problem_number %> ยังไม่ตรวจจำนวน <%= count203 %> ข้อ</p> 
      <% } %>

      <% if(count101 == 0 && count201 == 0 && count202 == 0 && count203 == 0 && count301 == 0) { %>
        <p>ข้อ <%= problem_number %> ถูกตรวจครบทุกข้อแล้ว</p>
      <% } %>

      <br>
      <div class='row'>
        <div class='col-2'>
          <div class="list-group">
            <a href="#" class="list-group-item list-group-item-action list-group-item-primary">บทที่ 1</a>
            <a href="/answers/problem/<%= locals.group_id %>/101" class="list-group-item list-group-item-action">ข้อ 1.1</a>
            <a href="#" class="list-group-item list-group-item-action list-group-item-primary">บทที่ 2</a>
            <a href="/answers/problem/<%= locals.group_id %>/201" class="list-group-item list-group-item-action">ข้อ 2.1</a>
            <a href="/answers/problem/<%= locals.group_id %>/202" class="list-group-item list-group-item-action">ข้อ 2.2</a>
            <a href="/answers/problem/<%= locals.group_id %>/203" class="list-group-item list-group-item-action">ข้อ 2.3</a>
            <a href="#" class="list-group-item list-group-item-action list-group-item-primary">บทที่ 3</a>
            <a href="/answers/problem/<%= locals.group_id %>/301" class="list-group-item list-group-item-action">ข้อ 3.1</a>
          </div>
        </div>
        <div class='col-10'>

          <% for (var result of locals.answers){ %>
            <div class="row">
              
              <div calss="col">
                
                <p>รหัสนักเรียน: <%= result.student_id %></p>
              </div>
              


              <div class="col">
                <div id="blocklyDiv" style="height: 250px; width: 600px;"></div>

                <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
                  <category name="Logic" colour="%{BKY_LOGIC_HUE}">
                    <block type="controls_if"></block>
                    <block type="logic_compare"></block>
                    <block type="logic_operation"></block>
                    <block type="logic_negate"></block>
                    <block type="logic_boolean"></block>
                    <block type="logic_null"></block>
                    <block type="logic_ternary"></block>
                  </category>
                  <category name="Loops" colour="%{BKY_LOOPS_HUE}">
                    <block type="controls_repeat_ext">
                      <value name="TIMES">
                        <shadow type="math_number">
                          <field name="NUM">10</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="controls_whileUntil"></block>
                    <block type="controls_for">
                      <value name="FROM">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                      <value name="TO">
                        <shadow type="math_number">
                          <field name="NUM">10</field>
                        </shadow>
                      </value>
                      <value name="BY">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="controls_forEach"></block>
                    <block type="controls_flow_statements"></block>
                  </category>
                  <category name="Math" colour="%{BKY_MATH_HUE}">
                    <block type="math_number">
                      <field name="NUM">123</field>
                    </block>
                    <block type="math_arithmetic">
                      <value name="A">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                      <value name="B">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_single">
                      <value name="NUM">
                        <shadow type="math_number">
                          <field name="NUM">9</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_trig">
                      <value name="NUM">
                        <shadow type="math_number">
                          <field name="NUM">45</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_constant"></block>
                    <block type="math_number_property">
                      <value name="NUMBER_TO_CHECK">
                        <shadow type="math_number">
                          <field name="NUM">0</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_round">
                      <value name="NUM">
                        <shadow type="math_number">
                          <field name="NUM">3.1</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_on_list"></block>
                    <block type="math_modulo">
                      <value name="DIVIDEND">
                        <shadow type="math_number">
                          <field name="NUM">64</field>
                        </shadow>
                      </value>
                      <value name="DIVISOR">
                        <shadow type="math_number">
                          <field name="NUM">10</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_constrain">
                      <value name="VALUE">
                        <shadow type="math_number">
                          <field name="NUM">50</field>
                        </shadow>
                      </value>
                      <value name="LOW">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                      <value name="HIGH">
                        <shadow type="math_number">
                          <field name="NUM">100</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_random_int">
                      <value name="FROM">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                      <value name="TO">
                        <shadow type="math_number">
                          <field name="NUM">100</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="math_random_float"></block>
                    <block type="math_atan2">
                      <value name="X">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                      <value name="Y">
                        <shadow type="math_number">
                          <field name="NUM">1</field>
                        </shadow>
                      </value>
                    </block>
                  </category>
                  <category name="Text" colour="%{BKY_TEXTS_HUE}">
                    <block type="text"></block>
                    <block type="text_join"></block>
                    <block type="text_append">
                      <value name="TEXT">
                        <shadow type="text"></shadow>
                      </value>
                    </block>
                    <block type="text_length">
                      <value name="VALUE">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_isEmpty">
                      <value name="VALUE">
                        <shadow type="text">
                          <field name="TEXT"></field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_indexOf">
                      <value name="VALUE">
                        <block type="variables_get">
                          <field name="VAR">{textVariable}</field>
                        </block>
                      </value>
                      <value name="FIND">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_charAt">
                      <value name="VALUE">
                        <block type="variables_get">
                          <field name="VAR">{textVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="text_getSubstring">
                      <value name="STRING">
                        <block type="variables_get">
                          <field name="VAR">{textVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="text_changeCase">
                      <value name="TEXT">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_trim">
                      <value name="TEXT">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_print">
                      <value name="TEXT">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="text_prompt_ext">
                      <value name="TEXT">
                        <shadow type="text">
                          <field name="TEXT">abc</field>
                        </shadow>
                      </value>
                    </block>
                  </category>
                  <category name="List" colour="%{BKY_LISTS_HUE}">
                    <block type="lists_create_with">
                      <mutation items="0"></mutation>
                    </block>
                    <block type="lists_create_with"></block>
                    <block type="lists_repeat">
                      <value name="NUM">
                        <shadow type="math_number">
                          <field name="NUM">5</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="lists_length"></block>
                    <block type="lists_isEmpty"></block>
                    <block type="lists_indexOf">
                      <value name="VALUE">
                        <block type="variables_get">
                          <field name="VAR">{listVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="lists_getIndex">
                      <value name="VALUE">
                        <block type="variables_get">
                          <field name="VAR">{listVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="lists_setIndex">
                      <value name="LIST">
                        <block type="variables_get">
                          <field name="VAR">{listVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="lists_getSublist">
                      <value name="LIST">
                        <block type="variables_get">
                          <field name="VAR">{listVariable}</field>
                        </block>
                      </value>
                    </block>
                    <block type="lists_split">
                      <value name="DELIM">
                        <shadow type="text">
                          <field name="TEXT">,</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="lists_sort"></block>
                  </category>
                  <category name="Colour" colour="%{BKY_COLOUR_HUE}">
                    <block type="colour_picker"></block>
                    <block type="colour_random"></block>
                    <block type="colour_rgb">
                      <value name="RED">
                        <shadow type="math_number">
                          <field name="NUM">100</field>
                        </shadow>
                      </value>
                      <value name="GREEN">
                        <shadow type="math_number">
                          <field name="NUM">50</field>
                        </shadow>
                      </value>
                      <value name="BLUE">
                        <shadow type="math_number">
                          <field name="NUM">0</field>
                        </shadow>
                      </value>
                    </block>
                    <block type="colour_blend">
                      <value name="COLOUR1">
                        <shadow type="colour_picker">
                          <field name="COLOUR">#ff0000</field>
                        </shadow>
                      </value>
                      <value name="COLOUR2">
                        <shadow type="colour_picker">
                          <field name="COLOUR">#3333ff</field>
                        </shadow>
                      </value>
                      <value name="RATIO">
                        <shadow type="math_number">
                          <field name="NUM">0.5</field>
                        </shadow>
                      </value>
                    </block>
                  </category>
                  <sep></sep>
                  <category name="Variables" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
                  <category name="Functions" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
                </xml>

                <script>
                  var xml_text = '<%- result.content %>';
                  var workspace = Blockly.inject('blocklyDiv',
                    {
                      media: 'https://unpkg.com/blockly/media/',
                      // toolbox: document.getElementById('toolbox')
                    });
                  var xml = Blockly.Xml.textToDom(xml_text);
                  Blockly.Xml.domToWorkspace(xml, workspace);
                </script>
              </div>

              <div class="col">
                <form class="" action="/answers/checked" method="post">
                  <input type="submit" name="isTrue" class="btn btn-success" value="ถูก">
                  <input type="submit" name="isTrue" class="btn btn-danger" value="ผิด">
                  <input type="hidden" name="student_id" value="<%= result.student_id %>">
                  <input type="hidden" name="group_id" value="<%= result.group_id %>">
                  <input type="hidden" name="lesson_id" value="<%= result.lesson_id %>">
                  <input type="hidden" name="problem_id" value="<%= result.problem_id %>">
                </form>
              </div>

              <% } %>
            </div>
        </div>
      </div>
</body>

</html>